<div class="flex flex-col">
  <div class="flex flex-row flex-wrap gap-2">
    <div class="stats shadow" *ngFor="let dataField of dataFields">
      <div class="stat">
        <div class="stat-title">{{dataField.label}}</div>
        <div class="stat-value" *ngIf="dataField.value">{{dataField.value}}</div>
        <div class="stat-value" *ngIf="!dataField.value">---</div>
        <div class="stat-desc"
             *ngIf="dataField.value">{{dataField.lastUpdate | amFromUtc | amLocal | amTimeAgo}}</div>
        <div class="stat-desc"
             *ngIf="!dataField.value">value not received
        </div>
      </div>
    </div>
  </div>

  <div class="mt-3">
    <form [formGroup]="deviceProfileForm" class="mt-5">
      <formly-form [form]="deviceProfileForm"
                   [fields]="deviceAttributesFormFields"
                   [model]="deviceAttributesModel">
      </formly-form>

      <div class="card-actions justify-start mt-10">
        <button *ngIf="deviceAttributesFormFields.length > 0" class="btn btn-accent btn-sm"
                [matMenuTriggerFor]="menu">DELETE ATTRIBUTE
          <fa-icon icon="caret-down" class="ml-1"></fa-icon>
          <mat-menu #menu="matMenu" xPosition="before">
            <button *ngFor="let field of deviceAttributesFormFields"
                    mat-menu-item
                    (click)="remove(field.key, field.props!.label!)">{{field.props?.label}}
            </button>
          </mat-menu>
        </button>
        <button class="btn btn-secondary btn-sm" (click)="add()">ADD ATTRIBUTE</button>
        <button class="btn btn-primary btn-sm" (click)="save()"
                [disabled]="!deviceProfileForm.dirty">SAVE ATTRIBUTES
        </button>
      </div>
    </form>
  </div>
</div>
