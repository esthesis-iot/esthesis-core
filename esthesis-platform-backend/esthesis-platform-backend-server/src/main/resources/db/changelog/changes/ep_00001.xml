<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.6.xsd"
  logicalFilePath="ep_00001.xml">
  <changeSet author="European Dynamics" id="1546611753105-1">
    <createTable tableName="application">
      <column name="id" autoIncrement="true" type="BIGINT UNSIGNED">
        <constraints primaryKey="true"/>
      </column>
      <column name="created_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="created_on" type="DATETIME"/>
      <column name="modified_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="modified_on" type="DATETIME"/>
      <column defaultValueComputed="NULL" name="version" type="INT"/>
      <column name="name" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="state" type="BIT(1)"/>
      <column name="token" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-4">
    <createTable tableName="audit">
      <column name="id" autoIncrement="true" type="BIGINT UNSIGNED">
        <constraints primaryKey="true"/>
      </column>
      <column name="created_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="created_on" type="DATETIME"/>
      <column name="modified_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="modified_on" type="DATETIME"/>
      <column defaultValueComputed="NULL" name="version" type="INT"/>
      <column name="description" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="event" type="VARCHAR(255)"/>
      <column name="level" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="user_id" type="BIGINT UNSIGNED"/>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-5">
    <createTable tableName="ca">
      <column name="id" autoIncrement="true" type="BIGINT UNSIGNED">
        <constraints primaryKey="true"/>
      </column>
      <column name="created_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="created_on" type="DATETIME"/>
      <column name="modified_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="modified_on" type="DATETIME"/>
      <column defaultValueComputed="NULL" name="version" type="INT"/>
      <column name="certificate" type="CLOB"/>
      <column name="cn" type="VARCHAR(256)">
        <constraints nullable="false"/>
      </column>
      <column defaultValueComputed="NULL" name="issued" type="datetime"/>
      <column name="parent_ca" type="VARCHAR(256)"/>
      <column name="private_key" type="CLOB"/>
      <column name="public_key" type="CLOB"/>
      <column name="validity" type="datetime">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-6">
    <createTable tableName="device">
      <column name="id" autoIncrement="true" type="BIGINT UNSIGNED">
        <constraints primaryKey="true"/>
      </column>
      <column name="created_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="created_on" type="DATETIME"/>
      <column name="modified_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="modified_on" type="DATETIME"/>
      <column defaultValueComputed="NULL" name="version" type="INT"/>
      <column name="device_id" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="private_key" type="VARCHAR(255)"/>
      <column name="public_key" type="VARCHAR(255)"/>
      <column name="state" type="VARCHAR(64)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-7">
    <createTable tableName="device_tags">
      <column name="device_id" type="BIGINT UNSIGNED">
        <constraints nullable="false"/>
      </column>
      <column name="tag_id" type="BIGINT UNSIGNED">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-8">
    <createTable tableName="mqtt_server">
      <column name="id" autoIncrement="true" type="BIGINT UNSIGNED">
        <constraints primaryKey="true"/>
      </column>
      <column name="created_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="created_on" type="DATETIME"/>
      <column name="modified_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="modified_on" type="DATETIME"/>
      <column defaultValueComputed="NULL" name="version" type="INT"/>
      <column name="configuration_token" type="VARCHAR(255)"/>
      <column name="ip_address" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="name" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="server_type" type="tinyint">
        <constraints nullable="false"/>
      </column>
      <column name="server_version" type="VARCHAR(255)"/>
      <column name="state" type="BIT(1)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-9">
    <createTable tableName="mqtt_server_tags">
      <column name="mqtt_server_id" type="BIGINT UNSIGNED">
        <constraints nullable="false"/>
      </column>
      <column name="tag_id" type="BIGINT UNSIGNED">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-10">
    <createTable tableName="provisioning">
      <column name="id" autoIncrement="true" type="BIGINT UNSIGNED">
        <constraints primaryKey="true"/>
      </column>
      <column name="created_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="created_on" type="DATETIME"/>
      <column name="modified_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="modified_on" type="DATETIME"/>
      <column defaultValueComputed="NULL" name="version" type="INT"/>
      <column name="description" type="VARCHAR(255)"/>
      <column name="file_content" type="BLOB">
        <constraints nullable="false"/>
      </column>
      <column name="file_size" type="BIGINT UNSIGNED">
        <constraints nullable="false"/>
      </column>
      <column name="name" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="package_version" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="state" type="BIT(1)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-11">
    <createTable tableName="provisioning_tags">
      <column name="provisioning_id" type="BIGINT UNSIGNED">
        <constraints nullable="false"/>
      </column>
      <column name="tag_id" type="BIGINT UNSIGNED">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-13">
    <createTable tableName="tag">
      <column name="id" autoIncrement="true" type="BIGINT UNSIGNED">
        <constraints primaryKey="true"/>
      </column>
      <column name="created_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="created_on" type="DATETIME"/>
      <column name="modified_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="modified_on" type="DATETIME"/>
      <column defaultValueComputed="NULL" name="version" type="INT"/>
      <column name="name" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-14">
    <createTable tableName="tunnel_server">
      <column name="id" autoIncrement="true" type="BIGINT UNSIGNED">
        <constraints primaryKey="true"/>
      </column>
      <column name="created_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="created_on" type="DATETIME"/>
      <column name="modified_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="modified_on" type="DATETIME"/>
      <column defaultValueComputed="NULL" name="version" type="INT"/>
      <column name="certificate" type="VARCHAR(255)"/>
      <column name="ip" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="name" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="parent_ca" type="BIGINT UNSIGNED">
        <constraints nullable="false"/>
      </column>
      <column name="private_key" type="VARCHAR(255)"/>
      <column name="public_key" type="VARCHAR(255)"/>
      <column name="status" type="BIT(1)">
        <constraints nullable="false"/>
      </column>
      <column name="token" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="validity" type="datetime">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-15">
    <createTable tableName="user">
      <column name="id" autoIncrement="true" type="BIGINT UNSIGNED">
        <constraints primaryKey="true"/>
      </column>
      <column name="created_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="created_on" type="DATETIME"/>
      <column name="modified_by" type="varchar(36)"/>
      <column defaultValueComputed="NULL" name="modified_on" type="DATETIME"/>
      <column defaultValueComputed="NULL" name="version" type="INT"/>
      <column name="email" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="fn" type="VARCHAR(255)"/>
      <column name="ln" type="VARCHAR(255)"/>
      <column name="password" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="salt" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="state" type="BIT(1)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-16">
    <createIndex indexName="FK4gwujkhuhxlltjq5vsdkqe4j5" tableName="mqtt_server_tags">
      <column name="mqtt_server_id"/>
    </createIndex>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-17">
    <createIndex indexName="FKcavqutwaxwd1gettpllppm372" tableName="device_tags">
      <column name="device_id"/>
    </createIndex>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-18">
    <createIndex indexName="FKmkpr7d3ck26fn1fuh6931e5ax" tableName="provisioning_tags">
      <column name="provisioning_id"/>
    </createIndex>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-19">
    <addForeignKeyConstraint baseColumnNames="mqtt_server_id" baseTableName="mqtt_server_tags"
      constraintName="FK4gwujkhuhxlltjq5vsdkqe4j5" deferrable="false" initiallyDeferred="false"
      onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id"
      referencedTableName="mqtt_server" validate="true"/>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-20">
    <addForeignKeyConstraint baseColumnNames="device_id" baseTableName="device_tags"
      constraintName="FKcavqutwaxwd1gettpllppm372" deferrable="false" initiallyDeferred="false"
      onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="device"
      validate="true"/>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-21">
    <addForeignKeyConstraint baseColumnNames="tag_id" baseTableName="device_tags"
      constraintName="FKfvachxq3jiw1kp1p36018ywp9" deferrable="false" initiallyDeferred="false"
      onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="tag"
      validate="true"/>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-22">
    <addForeignKeyConstraint baseColumnNames="tag_id" baseTableName="provisioning_tags"
      constraintName="FKj29sqvxmw82e0ki0iqjx1c3vl" deferrable="false" initiallyDeferred="false"
      onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="tag"
      validate="true"/>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-23">
    <addForeignKeyConstraint baseColumnNames="provisioning_id" baseTableName="provisioning_tags"
      constraintName="FKmkpr7d3ck26fn1fuh6931e5ax" deferrable="false" initiallyDeferred="false"
      onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id"
      referencedTableName="provisioning" validate="true"/>
  </changeSet>
  <changeSet author="European Dynamics" id="1546611753105-24">
    <addForeignKeyConstraint baseColumnNames="tag_id" baseTableName="mqtt_server_tags"
      constraintName="FKprm6g1yd3t05u0ctu6e0pypxs" deferrable="false" initiallyDeferred="false"
      onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="tag"
      validate="true"/>
  </changeSet>
</databaseChangeLog>
